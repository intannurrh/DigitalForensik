<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workspace Investigasi - UniSafe IRT</title>
    <meta name="description" content="Workspace Investigasi - Digital Forensics & Incident Response">
    
    <!-- Preload Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Styles -->
    <link rel="stylesheet" href="/.dist/output.css">
    <link rel="stylesheet" href="/src/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Chart.js untuk visualisasi -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Exo 2', sans-serif;
        }
        
        .sidebar {
            transition: transform 0.3s ease-in-out;
        }
        
        .sidebar.collapsed {
            transform: translateX(-100%);
        }
        
        .main-content {
            transition: margin-left 0.3s ease-in-out;
        }
        
        .main-content.expanded {
            margin-left: 0;
        }
        
        .burger-menu {
            display: block;
        }
        
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 30;
            display: none;
        }
        
        .sidebar-overlay.active {
            display: block;
        }
        
        @media (min-width: 769px) {
            .sidebar-overlay {
                display: none !important;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar:not(.collapsed) {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
        }
        
        .tab-button {
            position: relative;
            cursor: pointer;
            padding: 10px 16px;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .tab-button.active {
            border-bottom: 2px solid #E6B400;
            color: #E6B400;
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .evidence-item {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            background-color: #fff;
            margin-bottom: 12px;
            transition: all 0.2s;
        }
        
        .evidence-item:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .status-active {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .status-completed {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .priority-high {
            color: #dc2626;
        }
        
        .priority-medium {
            color: #d97706;
        }
        
        .priority-low {
            color: #059669;
        }
        
        .timeline-item {
            position: relative;
            padding-left: 30px;
            padding-bottom: 20px;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 9px;
            top: 6px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #E6B400;
            z-index: 1;
        }
        
        .timeline-item::after {
            content: '';
            position: absolute;
            left: 13px;
            top: 16px;
            width: 2px;
            height: calc(100% - 16px);
            background-color: #e5e7eb;
        }
        
        .timeline-item:last-child::after {
            display: none;
        }
        
        .hash-value {
            font-family: monospace;
            background-color: #f3f4f6;
            padding: 2px 4px;
            border-radius: 4px;
            font-size: 0.75rem;
        }
        
        .email-path {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background-color: #f9fafb;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .email-node {
            text-align: center;
            z-index: 2;
        }
        
        .email-connector {
            flex: 1;
            height: 2px;
            background-color: #E6B400;
            position: relative;
            margin: 0 10px;
        }
        
        .email-connector::after {
            content: '';
            position: absolute;
            right: 0;
            top: -4px;
            width: 0;
            height: 0;
            border-left: 8px solid #E6B400;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
        }
        
        .log-row {
            transition: background-color 0.2s;
        }
        
        .log-row:hover {
            background-color: #f9fafb;
        }
        
        .suspicious {
            background-color: #fef2f2 !important;
        }
        
        .editor-container {
            min-height: 300px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
        }
        
        .timer {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e40af;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <!-- Main Layout -->
    <div class="flex">
        <!-- Sidebar Overlay -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar w-64 bg-white shadow-sm h-screen fixed z-40">
            <div class="px-6 py-6 border-b flex items-center gap-3">
                <img src="/logo.png" alt="UniSafe Logo" class="h-10 w-auto">
            </div>

            <nav class="mt-6 px-4 space-y-1">
                <!-- Dashboard -->
                <a href="dashboard.html" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-chart-pie"></i>
                    <span>Dashboard</span>
                </a>

                <!-- Manajemen Insiden -->
                <a href="manajemenInsiden.html" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-list-check"></i>
                    <span>Manajemen Insiden</span>
                </a>

                <!-- Laporan Masuk -->
                <a href="incoming.html" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-file-lines"></i>
                    <span>Laporan Masuk</span>
                </a>

                <!-- Investigasi -->
                <a href="investigasi.html" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-folder-open"></i>
                    <span>Investigasi</span>
                </a>

                <!-- Workspace - Current Page -->
                <a href="workspace.html" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-800 font-medium transition" style="background-color: #E6B400;">
                    <i class="fa-solid fa-laptop-code"></i>
                    <span>Workspace</span>
                </a>

                <!-- Laporan Akhir -->
                <a href="finalReport.html" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-file-invoice"></i>
                    <span>Laporan Akhir</span>
                </a>

                <!-- Log Aktivitas -->
                <a href="logAktivitas.html" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-shield-halved"></i>
                    <span>Log Aktivitas</span>
                </a>
            </nav>

            <!-- Bottom Navigation -->
            <div class="absolute bottom-0 left-0 right-0 px-4 w-full pb-6">
                <div class="border-t border-gray-200 pt-2 mt-2 space-y-1">
                    <a href="setting.html" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition">
                        <i class="fa-solid fa-gear"></i>
                        <span>Pengaturan</span>
                    </a>
                    <a href="../login.html" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition">
                        <i class="fa-solid fa-right-from-bracket"></i>
                        <span>Keluar</span>
                    </a>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main id="mainContent" class="main-content ml-64 w-full min-h-screen px-8 py-6">

            <!-- Header -->
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center space-x-4">
                    <button id="burgerMenu" class="burger-menu text-gray-600 hover:text-gray-800 transition">
                        <i class="fa-solid fa-bars text-xl"></i>
                    </button>
                    <a href="investigasi.html" class="text-gray-600 hover:text-gray-800 transition">
                        <i class="fa-solid fa-arrow-left text-xl"></i>
                    </a>
                </div>

                <div class="flex items-center space-x-6">
                    <button class="relative">
                        <i class="fa-solid fa-bell text-xl text-gray-600"></i>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">2</span>
                    </button>

                    <div class="flex items-center space-x-3">
                        <img src="https://i.pravatar.cc/150?img=47" alt="Profile" class="w-10 h-10 rounded-full">
                        <div class="hidden sm:block">
                            <p class="text-sm font-semibold user-name">Admin IRT</p>
                            <p class="text-xs text-gray-500">Administrator</p>
                        </div>
                        <i class="fa-solid fa-chevron-down text-xs text-gray-500"></i>
                    </div>
                </div>
            </div>

            <!-- Page Content -->
            <div>
                
                <!-- Header Status Kasus -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                        <div class="mb-4 md:mb-0">
                            <div class="flex items-center gap-3 mb-2">
                                <h1 class="text-2xl font-bold text-gray-800">INC-2024-001</h1>
                                <span class="status-badge status-active">
                                    <i class="fa-solid fa-spinner fa-pulse mr-1"></i>
                                    Sedang Dianalisis
                                </span>
                            </div>
                            <h2 class="text-xl text-gray-700 mb-1">Phishing Attack Email Mahasiswa Fakultas Teknik</h2>
                            <div class="flex items-center gap-4 text-sm text-gray-600">
                                <span class="priority-high font-medium">
                                    <i class="fa-solid fa-exclamation-triangle mr-1"></i>
                                    Prioritas: Tinggi
                                </span>
                                <span>
                                    <i class="fa-solid fa-user mr-1"></i>
                                    Investigator: Admin IRT
                                </span>
                            </div>
                        </div>
                        <div class="text-center">
                            <p class="text-sm text-gray-600 mb-1">Durasi Investigasi</p>
                            <div class="timer" id="investigationTimer">00:00:00</div>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col lg:flex-row gap-6">
                    <!-- Main Content Area -->
                    <div class="flex-1">
                        <!-- Manajemen Barang Bukti -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold text-gray-800">
                                    <i class="fa-solid fa-lock mr-2 text-yellow-500"></i>
                                    Digital Evidence Locker
                                </h3>
                                <div class="flex gap-2">
                                    <button class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors text-sm" onclick="validateHashes()">
                                        <i class="fa-solid fa-fingerprint mr-1"></i>
                                        Validasi Hash
                                    </button>
                                    <button class="text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm" style="background-color: #E6B400;" onmouseover="this.style.backgroundColor='#D4A000'" onmouseout="this.style.backgroundColor='#E6B400'" onclick="openEvidenceModal()">
                                        <i class="fa-solid fa-plus mr-1"></i>
                                        Tambah Bukti
                                    </button>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Bukti</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hash (SHA256)</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal Diakuisisi</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Chain of Custody</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200" id="evidenceTableBody">
                                        <!-- Evidence items will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Workspace Analisis -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <i class="fa-solid fa-microscope mr-2 text-yellow-500"></i>
                                Workspace Analisis
                            </h3>
                            
                            <!-- Tab Navigation -->
                            <div class="border-b border-gray-200 mb-6">
                                <nav class="-mb-px flex space-x-8">
                                    <button class="tab-button active" onclick="switchTab('emailAnalysis')">
                                        <i class="fa-solid fa-envelope-open-text mr-1"></i>
                                        Analisis Header Email
                                    </button>
                                    <button class="tab-button" onclick="switchTab('accessLogs')">
                                        <i class="fa-solid fa-list mr-1"></i>
                                        Log Akses
                                    </button>
                                    <button class="tab-button" onclick="switchTab('investigatorNotes')">
                                        <i class="fa-solid fa-sticky-note mr-1"></i>
                                        Catatan Investigator
                                    </button>
                                </nav>
                            </div>
                            
                            <!-- Tab Content -->
                            <div id="emailAnalysis" class="tab-content active">
                                <div class="email-path">
                                    <div class="email-node">
                                        <div class="bg-blue-100 p-4 rounded-lg">
                                            <i class="fa-solid fa-user-secret text-2xl text-blue-600 mb-2"></i>
                                            <p class="text-sm font-medium">Attacker</p>
                                            <p class="text-xs text-gray-600">192.168.1.105</p>
                                            <p class="text-xs text-gray-500">Moscow, RU</p>
                                        </div>
                                    </div>
                                    <div class="email-connector"></div>
                                    <div class="email-node">
                                        <div class="bg-green-100 p-4 rounded-lg">
                                            <i class="fa-solid fa-server text-2xl text-green-600 mb-2"></i>
                                            <p class="text-sm font-medium">Mail Server</p>
                                            <p class="text-xs text-gray-600">smtp.uni-safe.edu</p>
                                            <p class="text-xs text-gray-500">Gmail Relay</p>
                                        </div>
                                    </div>
                                    <div class="email-connector"></div>
                                    <div class="email-node">
                                        <div class="bg-red-100 p-4 rounded-lg">
                                            <i class="fa-solid fa-user-graduate text-2xl text-red-600 mb-2"></i>
                                            <p class="text-sm font-medium">Victim</p>
                                            <p class="text-xs text-gray-600">300+ Mahasiswa</p>
                                            <p class="text-xs text-gray-500">Fakultas Teknik</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-gray-800 mb-3">Header Analysis Results</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <p class="text-sm text-gray-600">From:</p>
                                            <p class="text-sm font-medium">support@universitas-announcement[.]com</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-600">Reply-To:</p>
                                            <p class="text-sm font-medium text-red-600">phisher@darkweb[.]xyz</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-600">SPF Result:</p>
                                            <p class="text-sm font-medium text-red-600">FAIL</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-600">DKIM Result:</p>
                                            <p class="text-sm font-medium text-red-600">FAIL</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-600">DMARC Result:</p>
                                            <p class="text-sm font-medium text-red-600">FAIL</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-600">Authentication:</p>
                                            <p class="text-sm font-medium text-red-600">NONE</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="accessLogs" class="tab-content">
                                <div class="mb-4 flex justify-between items-center">
                                    <div class="flex gap-2">
                                        <button class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-3 py-2 rounded-lg font-medium transition-colors text-sm">
                                            <i class="fa-solid fa-filter mr-1"></i>
                                            Filter
                                        </button>
                                        <button class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-3 py-2 rounded-lg font-medium transition-colors text-sm">
                                            <i class="fa-solid fa-download mr-1"></i>
                                            Export
                                        </button>
                                    </div>
                                    <div class="text-sm text-gray-600">
                                        <i class="fa-solid fa-exclamation-triangle text-red-500 mr-1"></i>
                                        3 akses mencurigakan terdeteksi
                                    </div>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">IP Address</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white divide-y divide-gray-200" id="accessLogsBody">
                                            <!-- Access logs will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div id="investigatorNotes" class="tab-content">
                                <div class="mb-4 flex justify-between items-center">
                                    <h4 class="font-medium text-gray-800">Catatan Investigasi Real-time</h4>
                                    <button class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-3 py-2 rounded-lg font-medium transition-colors text-sm" onclick="saveNotes()">
                                        <i class="fa-solid fa-save mr-1"></i>
                                        Simpan Catatan
                                    </button>
                                </div>
                                
                                <div class="editor-container" contenteditable="true" id="notesEditor">
                                    <h4>TINDAKAN AWAL - 05/12/2024 09:30</h4>
                                    <ul>
                                        <li>Menerima laporan dari 15 mahasiswa mengenai email phishing yang mengatasnamakan fakultas</li>
                                        <li>Memulai analisis header email untuk melacak sumber asli</li>
                                        <li>Mengidentifikasi 3 domain mencurigakan yang terkait dengan serangan</li>
                                    </ul>
                                    
                                    <h4>ANALISIS FORENSIK - 05/12/2024 11:15</h4>
                                    <ul>
                                        <li>IP address melacak ke lokasi Moscow, Russia</li>
                                        <li>Mengidentifikasi teknik spoofing pada header email</li>
                                        <li>Malware yang terdeteksi: keylogger dengan enkripsi RC4</li>
                                    </ul>
                                    
                                    <h4>REKOMENDASI TINDAKAN - 05/12/2024 14:30</h4>
                                    <ul>
                                        <li>Immediate takedown dari 3 domains yang teridentifikasi</li>
                                        <li>Force password reset untuk semua mahasiswa yang mengklik link</li>
                                        <li>Implementasi SPF/DKIM/DMARC record yang lebih strict</li>
                                    </ul>
                                </div>
                                
                                <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                                    <p class="text-sm text-gray-600">
                                        <i class="fa-solid fa-info-circle mr-1"></i>
                                        Catatan tersimpan otomatis setiap 5 menit. Terakhir disimpan: <span id="lastSaved">-</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sidebar Timeline -->
                    <div class="lg:w-80">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 sticky top-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <i class="fa-solid fa-clock-rotate-left mr-2 text-yellow-500"></i>
                                Timeline Insiden
                            </h3>
                            
                            <div class="space-y-1" id="incidentTimeline">
                                <!-- Timeline items will be populated here -->
                            </div>
                            
                            <div class="mt-6 pt-4 border-t border-gray-200">
                                <button class="w-full text-white px-4 py-2 rounded-lg font-medium transition-colors" style="background-color: #E6B400;" onmouseover="this.style.backgroundColor='#D4A000'" onmouseout="this.style.backgroundColor='#E6B400'" onclick="addTimelineEvent()">
                                    <i class="fa-solid fa-plus mr-1"></i>
                                    Tambah Event
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal for New Evidence -->
    <div id="evidenceModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-gray-800">Tambah Barang Bukti Baru</h2>
                <button class="text-gray-500 hover:text-gray-700" onclick="closeEvidenceModal()">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="evidenceForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Bukti</label>
                    <input type="text" id="evidenceName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:outline-none" onfocus="this.style.boxShadow='0 0 0 2px #E6B400'" onblur="this.style.boxShadow='none'" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipe Bukti</label>
                    <select id="evidenceType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:outline-none" onfocus="this.style.boxShadow='0 0 0 2px #E6B400'" onblur="this.style.boxShadow='none'" required>
                        <option value="">Pilih Tipe</option>
                        <option value="email">Email (.eml)</option>
                        <option value="log">Log File</option>
                        <option value="pcap">Network Capture</option>
                        <option value="image">Image</option>
                        <option value="document">Document</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Upload File</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors cursor-pointer" onclick="document.getElementById('evidenceFile').click()">
                        <i class="fa-solid fa-cloud-arrow-up text-3xl text-gray-400 mb-2"></i>
                        <p class="text-gray-600">Klik untuk upload atau drag & drop file</p>
                        <p class="text-sm text-gray-500">Max file size: 50MB</p>
                        <input type="file" id="evidenceFile" class="hidden" onchange="handleFileSelect(this)">
                    </div>
                    <div id="fileInfo" class="mt-2 text-sm text-gray-600"></div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="evidenceDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:outline-none" onfocus="this.style.boxShadow='0 0 0 2px #E6B400'" onblur="this.style.boxShadow='none'"></textarea>
                </div>
                
                <div class="flex justify-end gap-2">
                    <button type="button" class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-6 py-2 rounded-lg font-medium transition-colors" onclick="closeEvidenceModal()">
                        Batal
                    </button>
                    <button type="submit" class="text-white px-6 py-2 rounded-lg font-medium transition-colors" style="background-color: #E6B400;" onmouseover="this.style.backgroundColor='#D4A000'" onmouseout="this.style.backgroundColor='#E6B400'">
                        <i class="fa-solid fa-plus mr-1"></i>
                        Tambah Bukti
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Timeline Event -->
    <div id="timelineModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-gray-800">Tambah Event Timeline</h2>
                <button class="text-gray-500 hover:text-gray-700" onclick="closeTimelineModal()">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="timelineForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Waktu Event</label>
                    <input type="datetime-local" id="eventTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:outline-none" onfocus="this.style.boxShadow='0 0 0 2px #E6B400'" onblur="this.style.boxShadow='none'" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi Event</label>
                    <textarea id="eventDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:outline-none" onfocus="this.style.boxShadow='0 0 0 2px #E6B400'" onblur="this.style.boxShadow='none'" required></textarea>
                </div>
                
                <div class="flex justify-end gap-2">
                    <button type="button" class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-6 py-2 rounded-lg font-medium transition-colors" onclick="closeTimelineModal()">
                        Batal
                    </button>
                    <button type="submit" class="text-white px-6 py-2 rounded-lg font-medium transition-colors" style="background-color: #E6B400;" onmouseover="this.style.backgroundColor='#D4A000'" onmouseout="this.style.backgroundColor='#E6B400'">
                        <i class="fa-solid fa-plus mr-1"></i>
                        Tambah Event
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Styles for modals -->
    <style>
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            border-radius: 8px;
        }
    </style>

    <!-- Scripts -->
    <script>
        // Initialize data
        let evidenceList = [
            {
                id: 'EV-001',
                name: 'Phishing Email Sample.eml',
                hash: 'a1b2c3d4e5f6789abcdef1234567890abcdef1234567890abcdef1234567890',
                acquiredDate: '2024-12-05 09:45:00',
                chainOfCustody: 'Admin IRT → Tim Forensik → Penyidik',
                status: 'verified'
            },
            {
                id: 'EV-002',
                name: 'Email Server Logs_Dec2024.log',
                hash: 'f6e5d4c3b2a17890abcdef1234567890abcdef1234567890abcdef1234567890',
                acquiredDate: '2024-12-05 10:30:00',
                chainOfCustody: 'Admin IRT → Tim Forensik',
                status: 'verified'
            },
            {
                id: 'EV-003',
                name: 'Network_Capture.pcap',
                hash: 'z9y8x7w6v5u4t3r2e1w0q9a8s7d6f5g4h3j2k1l0z9x8c7v6b5n4m3',
                acquiredDate: '2024-12-05 11:15:00',
                chainOfCustody: 'Admin IRT → Tim Forensik',
                status: 'verified'
            }
        ];
        
        let accessLogs = [
            {
                timestamp: '2024-12-05 09:12:34',
                user: 'mahasiswa123@uni-safe.edu',
                ip: '192.168.1.105',
                location: 'Moscow, Russia',
                action: 'Login Successful',
                status: 'suspicious'
            },
            {
                timestamp: '2024-12-05 09:15:22',
                user: 'mahasiswa456@uni-safe.edu',
                ip: '192.168.1.105',
                location: 'Moscow, Russia',
                action: 'Password Change Request',
                status: 'suspicious'
            },
            {
                timestamp: '2024-12-05 09:18:45',
                user: 'mahasiswa789@uni-safe.edu',
                ip: '103.21.244.0',
                location: 'Singapore',
                action: 'Login Successful',
                status: 'normal'
            },
            {
                timestamp: '2024-12-05 09:22:10',
                user: 'mahasiswa101@uni-safe.edu',
                ip: '192.168.1.105',
                location: 'Moscow, Russia',
                action: 'Download Transcript',
                status: 'suspicious'
            },
            {
                timestamp: '2024-12-05 09:25:33',
                user: 'mahasiswa202@uni-safe.edu',
                ip: '114.124.140.89',
                location: 'Jakarta, Indonesia',
                action: 'Login Successful',
                status: 'normal'
            }
        ];
        
        let timelineEvents = [
            {
                date: '2024-12-05 09:00',
                description: 'Laporan diterima dari 15 mahasiswa mengenai email mencurigakan'
            },
            {
                date: '2024-12-05 09:30',
                description: 'Mulai investigasi dan pengumpulan evidence'
            },
            {
                date: '2024-12-05 11:00',
                description: 'Analisis email dan domain terkait - domain dari Rusia'
            },
            {
                date: '2024-12-05 14:00',
                description: 'Identifikasi IP source dan lokasi geografis'
            },
            {
                date: '2024-12-05 16:30',
                description: 'Isolasi malware dan blacklist domains'
            }
        ];
        
        // Timer functionality
        let startTime = new Date('2024-12-05T09:00:00');
        let timerInterval;
        
        function updateTimer() {
            const now = new Date();
            const diff = now - startTime;
            
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('investigationTimer').textContent = 
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Set user role in localStorage if not set
            if (!localStorage.getItem('userRole')) {
                localStorage.setItem('userRole', 'irt');
            }
            if (!localStorage.getItem('username')) {
                localStorage.setItem('username', 'Admin IRT');
            }
            
            // Start timer
            timerInterval = setInterval(updateTimer, 1000);
            updateTimer();
            
            // Populate data
            renderEvidenceTable();
            renderAccessLogs();
            renderTimeline();
            
            // Initialize sidebar
            initializeSidebar();
            
            // Auto-save notes every 5 minutes
            setInterval(saveNotes, 300000);
        });
        
        // Render functions
        function renderEvidenceTable() {
            const tbody = document.getElementById('evidenceTableBody');
            tbody.innerHTML = evidenceList.map(evidence => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <i class="fa-solid fa-file text-gray-400 mr-3"></i>
                            <div>
                                <div class="text-sm font-medium text-gray-900">${evidence.name}</div>
                                <div class="text-xs text-gray-500">ID: ${evidence.id}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="hash-value">${evidence.hash.substring(0, 20)}...</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${evidence.acquiredDate}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-xs text-gray-500">${evidence.chainOfCustody}</div>
                        <div class="text-xs mt-1">
                            <span class="text-green-600">
                                <i class="fa-solid fa-check-circle mr-1"></i>
                                ${evidence.status}
                            </span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-2" onclick="downloadEvidence('${evidence.id}')">
                            <i class="fa-solid fa-download"></i>
                        </button>
                        <button class="text-gray-600 hover:text-gray-900" onclick="viewEvidence('${evidence.id}')">
                            <i class="fa-solid fa-eye"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }
        
        function renderAccessLogs() {
            const tbody = document.getElementById('accessLogsBody');
            tbody.innerHTML = accessLogs.map(log => `
                <tr class="log-row ${log.status === 'suspicious' ? 'suspicious' : ''}">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${log.timestamp}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${log.user}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${log.ip}
                        ${log.status === 'suspicious' ? '<i class="fa-solid fa-exclamation-triangle text-red-500 ml-1"></i>' : ''}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${log.location}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${log.action}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${log.status === 'suspicious' ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}">
                            ${log.status === 'suspicious' ? 'Mencurigakan' : 'Normal'}
                        </span>
                    </td>
                </tr>
            `).join('');
        }
        
        function renderTimeline() {
            const container = document.getElementById('incidentTimeline');
            container.innerHTML = timelineEvents.map(event => `
                <div class="timeline-item">
                    <div class="text-sm font-medium text-gray-900">${event.date}</div>
                    <div class="text-sm text-gray-600">${event.description}</div>
                </div>
            `).join('');
        }
        
        // Tab switching
        function switchTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
        
        // Modal functions
        function openEvidenceModal() {
            document.getElementById('evidenceModal').style.display = 'block';
        }
        
        function closeEvidenceModal() {
            document.getElementById('evidenceModal').style.display = 'none';
            document.getElementById('evidenceForm').reset();
        }
        
        function openTimelineModal() {
            document.getElementById('timelineModal').style.display = 'block';
            // Set default time to current time
            const now = new Date();
            const localDateTime = new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString().slice(0, 16);
            document.getElementById('eventTime').value = localDateTime;
        }
        
        function closeTimelineModal() {
            document.getElementById('timelineModal').style.display = 'none';
            document.getElementById('timelineForm').reset();
        }
        
        function addTimelineEvent() {
            openTimelineModal();
        }
        
        function handleFileSelect(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                document.getElementById('fileInfo').innerHTML = `
                    <i class="fa-solid fa-file mr-1"></i>
                    ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)
                `;
                
                // In a real app, this would calculate the actual hash of the file
                // For demo purposes, we'll use a placeholder
                console.log('File selected:', file.name);
            }
        }
        
        // Form submissions
        document.getElementById('evidenceForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newEvidence = {
                id: 'EV-' + String(evidenceList.length + 1).padStart(3, '0'),
                name: document.getElementById('evidenceName').value,
                hash: 't' + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15),
                acquiredDate: new Date().toLocaleString(),
                chainOfCustody: 'Admin IRT',
                status: 'verified'
            };
            
            evidenceList.push(newEvidence);
            renderEvidenceTable();
            closeEvidenceModal();
            
            showNotification('Barang bukti berhasil ditambahkan', 'success');
        });
        
        document.getElementById('timelineForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const eventTime = document.getElementById('eventTime').value;
            const eventDescription = document.getElementById('eventDescription').value;
            
            // Format date for display
            const date = new Date(eventTime);
            const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
            
            const newEvent = {
                date: formattedDate,
                description: eventDescription
            };
            
            timelineEvents.push(newEvent);
            timelineEvents.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            renderTimeline();
            closeTimelineModal();
            
            showNotification('Event timeline berhasil ditambahkan', 'success');
        });
        
        // Action functions
        function validateHashes() {
            showNotification('Validasi hash berhasil. Semua bukti terverifikasi integritasnya.', 'success');
        }
        
        function downloadEvidence(evidenceId) {
            const evidence = evidenceList.find(e => e.id === evidenceId);
            if (evidence) {
                showNotification(`Mengunduh ${evidence.name}...`, 'info');
                // In a real app, this would trigger a file download
            }
        }
        
        function viewEvidence(evidenceId) {
            const evidence = evidenceList.find(e => e.id === evidenceId);
            if (evidence) {
                showNotification(`Melihat detail ${evidence.name}`, 'info');
                // In a real app, this would open a file viewer
            }
        }
        
        function saveNotes() {
            const notesContent = document.getElementById('notesEditor').innerHTML;
            const now = new Date();
            const formattedTime = now.toLocaleString();
            
            // In a real app, this would save to a backend
            localStorage.setItem('investigatorNotes', notesContent);
            
            document.getElementById('lastSaved').textContent = formattedTime;
            showNotification('Catatan berhasil disimpan', 'success');
        }
        
        // Notification function
        function showNotification(message, type) {
            let bgColor, icon;
            
            switch(type) {
                case 'success':
                    bgColor = 'bg-green-500';
                    icon = 'fa-check-circle';
                    break;
                case 'warning':
                    bgColor = 'bg-yellow-500';
                    icon = 'fa-exclamation-triangle';
                    break;
                case 'error':
                    bgColor = 'bg-red-500';
                    icon = 'fa-times-circle';
                    break;
                default:
                    bgColor = 'bg-blue-500';
                    icon = 'fa-info-circle';
            }
            
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300`;
            notification.style.transform = 'translateY(-100px)';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fa-solid ${icon} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateY(0)';
            }, 10);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // Initialize sidebar functionality
        function initializeSidebar() {
            const burgerMenu = document.getElementById('burgerMenu');
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            
            // Toggle sidebar on mobile
            burgerMenu.addEventListener('click', function() {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
                sidebarOverlay.classList.toggle('active');
            });
            
            // Close sidebar when clicking overlay
            sidebarOverlay.addEventListener('click', function() {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('expanded');
                sidebarOverlay.classList.remove('active');
            });
            
            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth >= 769) {
                    sidebar.classList.remove('collapsed');
                    mainContent.classList.remove('expanded');
                    sidebarOverlay.classList.remove('active');
                }
            });
            
            // Set initial state for mobile
            if (window.innerWidth <= 768) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('expanded');
            }
        }
    </script>
</body>
</html>
